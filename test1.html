<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <title>Mini Site Dolan Sawah - Pro Admin</title>
    <style>
        /* =========================================
           1. CSS ORIGINAL WEBSITE
           ========================================= */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Poppins', sans-serif; text-align: center; color: black;
            transition: background 0.5s ease; line-height: 1.6; background-color: #f0f0f0;
        }
        body.theme-home { background: linear-gradient(135deg, #ff9800, #ffcc80); }
        body.theme-menu { background: linear-gradient(135deg, #ff9800, #e65100); }
        body.theme-gallery { background: linear-gradient(135deg, #f6d365, #fda085); }
        body.theme-jadwal { background: linear-gradient(135deg, #f6d365, #fda085); }
        body.theme-reguler { background: linear-gradient(135deg, #f5f7fa, #c3cfe2); }
        body.theme-jeep { background: linear-gradient(135deg, #414345, #232526); }
        
        .page-content { display: none; padding: 20px 15px; animation: fadeIn 0.8s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        
        .loading-screen {
            position: fixed; width: 100%; height: 100%; background: white;
            display: flex; justify-content: center; align-items: center; flex-direction: column; z-index: 6000;
        }
        .loading-bar { width: 80%; max-width: 300px; height: 8px; background: #ddd; border-radius: 5px; overflow: hidden; margin-top: 10px; }
        .loading-fill { width: 0%; height: 100%; background: linear-gradient(90deg, #ff9800, #ff5722); transition: width 0.2s; }
        .loading-text { font-size: 18px; margin-top: 10px; font-weight: bold; color: #ff9800; }

        #page-home .header-gallery { width: 100%; position: fixed; top: 0; left: 0; z-index: 1000; background: white; box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1); cursor: pointer; }
        #page-home .header-gallery img { width: 100%; height: auto; max-height: 200px; object-fit: cover; }
        #page-home .main-container { max-width: 800px; margin: 0 auto; padding: 220px 20px 80px; background: white; border-radius: 15px; box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.15); position: relative; }
        
        .slideshow-container { width: 100%; aspect-ratio: 16 / 9; position: relative; overflow: hidden; border-radius: 10px; margin-bottom: 25px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .slide-image { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 1.5s ease-in-out; }
        .slide-image.active { opacity: 1; }
        .frame-overlay { position: absolute; top: 0; left: 0; width: 30%; height: auto; z-index: 20; pointer-events: none; }
        @media screen and (max-width: 480px) { .frame-overlay { width: 40%; } }

        .menu-grid-container { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 10px 0; width: 100%; }
        .menu-card { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px 10px; border-radius: 15px; text-decoration: none; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s, box-shadow 0.2s; height: 100%; aspect-ratio: 1.3 / 1; cursor: pointer; }
        .menu-card:active { transform: scale(0.95); }
        .menu-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.2); }
        .menu-card svg { width: 36px; height: 36px; margin-bottom: 10px; fill: white; }
        .menu-card span { font-size: 0.95rem; font-weight: 600; text-align: center; line-height: 1.2; }
        
        .bg-orange { background: linear-gradient(135deg, #ff9800, #f57c00); }
        .bg-green  { background: linear-gradient(135deg, #4caf50, #2e7d32); }
        .bg-blue   { background: linear-gradient(135deg, #2196f3, #1976d2); }
        .full-width-btn { grid-column: span 2; flex-direction: row; aspect-ratio: auto; padding: 15px; background: linear-gradient(135deg, #d32f2f, #c62828); border: 2px solid #ffeb3b; animation: blink-effect 1.5s infinite alternate; }
        .full-width-btn svg { margin-bottom: 0; margin-right: 10px; }
        @keyframes blink-effect { from { box-shadow: 0px 0px 5px rgba(255, 152, 0, 0.5); } to { box-shadow: 0px 0px 15px rgba(255, 152, 0, 1); } }

        #page-home .floating-button { display: flex; justify-content: center; align-items: center; gap: 10px; width: 90%; max-width: 320px; padding: 14px; margin: 30px auto 10px; font-size: clamp(1rem, 4vw, 1.1rem); font-weight: bold; text-decoration: none; color: black; background: linear-gradient(45deg, #ffeb3b, #fbc02d); border-radius: 10px; border: none; cursor: pointer; box-shadow: 0px 5px 15px rgba(255, 235, 59, 0.7); animation: blink-float 1.5s infinite alternate; }
        #page-home .floating-button svg { width: 24px; height: 24px; }
        @keyframes blink-float { from { opacity: 1; transform: scale(1); } 50% { opacity: 0.9; transform: scale(1.02); } to { opacity: 1; transform: scale(1); } }
        
        #floating-home-button { position: fixed; bottom: 20px; left: 20px; background: linear-gradient(45deg, #ff9800, #ff5722); color: white; border-radius: 30px; border: none; display: none; align-items: center; gap: 8px; padding: 10px 20px; font-weight: bold; font-size: 14px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 3500; transition: transform 0.2s; }
        #floating-home-button:hover { transform: scale(1.1); }
        #floating-home-button svg { width: 20px; height: 20px; }

        @keyframes bounce-button { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        #floating-member-button { position: fixed; bottom: 20px; right: 20px; width: 140px; height: 140px; background: transparent; border: none; padding: 0; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 3500; text-decoration: none; animation: bounce-button 1.5s infinite ease-in-out; }
        #floating-member-button img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }

        #page-menu .container { max-width: 600px; margin: auto; background: #111; padding: 20px; border-radius: 12px; box-shadow: 0px 0px 15px rgba(255, 152, 0, 0.8); color: white; }
        #page-menu h1 { font-size: clamp(1.8rem, 5vw, 2.2rem); color: #ff9800; text-shadow: 0 0 10px rgba(255, 152, 0, 0.8); margin-bottom: 20px; }
        #page-menu h2 { font-size: clamp(1.2rem, 4vw, 1.5rem); color: #fbc02d; margin-top: 30px; margin-bottom: 15px; }
        #page-menu .image-container { display: flex; justify-content: center; margin-bottom: 20px; cursor: pointer;}
        #page-menu .image-container img { width: 100%; max-width: 100%; border-radius: 10px; border: 3px solid #ff9800; transition: transform 0.3s; }
        #page-menu .image-container img:hover { transform: scale(1.05); }

        #page-gallery .container { max-width: 95%; margin: 20px auto; padding: 20px; background: white; border-radius: 15px; box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.15); }
        #page-gallery .gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; padding: 10px; }
        #page-gallery .gallery img { width: 100%; height: 100%; object-fit: cover; aspect-ratio: 1 / 1; border-radius: 10px; cursor: pointer; transition: transform 0.3s; }
        #page-gallery .gallery img:hover { transform: scale(1.05); }

        #page-jeep .container { max-width: 1200px; margin: 0 auto; padding: 20px 15px; }
        #page-jeep h1 { font-size: clamp(2rem, 6vw, 2.8rem); color: #f39c12; text-transform: uppercase; margin-bottom: 10px; text-shadow: 2px 2px 8px rgba(0,0,0,0.7); }
        #page-jeep p.subtitle { font-size: clamp(1rem, 3vw, 1.2rem); color: #ccc; margin-bottom: 40px; }
        .jeep-packages-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
        .jeep-package-card { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 15px; color: white; cursor: pointer; transition: transform 0.3s; box-shadow: 0 4px 15px rgba(0,0,0,0.3); overflow: hidden; display: flex; flex-direction: column; }
        .jeep-package-card:hover { transform: translateY(-10px); background: rgba(255, 255, 255, 0.1); }
        .jeep-package-card img { width: 100%; aspect-ratio: 1 / 1; object-fit: cover; }
        .jeep-package-card .card-content { padding: 20px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; justify-content: center; }
        .jeep-package-card h3 { color: #f39c12; margin-bottom: 10px; font-size: 1.3rem; }

        #page-reguler .menu-container { max-width: 800px; margin: 0 auto; padding-bottom: 80px; }
        #page-reguler h1 { color: #2c3e50; margin-bottom: 25px; font-size: clamp(2rem, 6vw, 2.5rem); }
        #page-reguler .menu-category { background: white; border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin-bottom: 30px; padding: 20px; text-align: left; overflow: hidden; }
        #page-reguler .category-title { color: #e67e22; padding-bottom: 10px; margin-bottom: 20px; border-bottom: 2px solid #f39c12; font-size: clamp(1.4rem, 5vw, 1.8rem); }
        #page-reguler .menu-item { display: flex; justify-content: space-between; align-items: baseline; padding: 12px 0; border-bottom: 1px dashed #bdc3c7; }
        #page-reguler .menu-item:last-child { border-bottom: none; }
        #page-reguler .item-price { font-weight: bold; background-color: #f1c40f; padding: 3px 8px; border-radius: 5px; }

        /* PERBAIKAN CSS UNTUK FULLSCREEN MODAL & TOMBOL CLOSE */
        .fullscreen-modal { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0, 0, 0, 0.95); display: none; 
            justify-content: center; align-items: center; 
            opacity: 0; visibility: hidden; transition: opacity 0.3s; 
            z-index: 5000; 
        }
        .fullscreen-modal.show { display: flex; opacity: 1; visibility: visible; }
        .fullscreen-modal img { 
            max-width: 95%; max-height: 85%; 
            border-radius: 5px; box-shadow: 0 0 20px rgba(255,255,255,0.2); 
            z-index: 5001; /* Pastikan gambar di bawah tombol close */
        }
        .close-btn { 
            position: absolute; 
            top: 30px; 
            right: 30px; 
            font-size: 24px; 
            color: white; 
            background: rgba(255, 0, 0, 0.8); /* Warna Merah Transparan */
            border: 2px solid white; /* Garis tepi putih */
            border-radius: 50%; 
            width: 45px; 
            height: 45px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            z-index: 6000; /* LEBIH TINGGI DARI MODAL DAN GAMBAR */
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            transition: transform 0.2s;
        }
        .close-btn:hover {
            transform: scale(1.1);
            background: rgb(255, 0, 0);
        }
        
        .popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); display: none; justify-content: center; align-items: center; z-index: 4000; padding: 20px; animation: fadeInPopup 0.3s ease-out; }
        .popup-overlay.show { display: flex; }
        .popup-content { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); max-width: 500px; width: 100%; text-align: center; position: relative; }
        .popup-button { background: #ff5722; color: white; padding: 10px 30px; border-radius: 8px; border: none; cursor: pointer; margin-top: 15px; }
        @keyframes fadeInPopup { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        #scroll-indicator { position: fixed; bottom: 20px; right: 20px; background: rgba(0, 0, 0, 0.6); color: white; padding: 8px 15px; border-radius: 20px; font-size: 14px; z-index: 3000; display: none; align-items: center; gap: 5px; animation: bounce 2s infinite ease-in-out; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        @media screen and (max-width: 768px) { #page-home .main-container { padding-top: 180px; } }
        @media screen and (max-width: 480px) { #page-home .main-container { padding-top: 160px; padding-left: 15px; padding-right: 15px; } #page-reguler .item-dots { display: none; } }

        /* =========================================
           2. CSS ADMIN DASHBOARD (IMPROVED & EXPANDED)
           ========================================= */
        .admin-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9999; justify-content: center; align-items: center; }
        .admin-box { background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 400px; text-align: center; box-shadow: 0 0 20px rgba(255,152,0, 0.5); }
        .admin-box input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; font-size: 16px;}
        .admin-box button { width: 100%; padding: 12px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin-top: 10px; font-size: 16px;}
        .admin-box button.close-admin { background: #555; margin-top: 5px; }

        .admin-panel-btn { display: none; position: fixed; top: 20px; right: 20px; z-index: 8000; background: #d32f2f; color: white; padding: 10px 20px; border-radius: 30px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.3); border: 2px solid white; transition: transform 0.2s;}
        .admin-panel-btn:hover { transform: scale(1.05); }
        
        .admin-dashboard { display: none; position: fixed; top: 0; right: 0; width: 100%; max-width: 450px; height: 100%; background: #f4f4f4; z-index: 9000; overflow-y: auto; padding: 0; box-shadow: -5px 0 15px rgba(0,0,0,0.2); }
        .dashboard-header { background: white; padding: 20px; border-bottom: 2px solid #ff9800; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 10;}
        .dashboard-content { padding: 20px; padding-bottom: 100px; }
        
        .upload-group { border: 1px solid #e0e0e0; padding: 15px; margin-bottom: 20px; border-radius: 10px; text-align: left; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .upload-group h3 { font-size: 16px; margin-bottom: 15px; color: #e65100; border-bottom: 2px solid #fff3e0; padding-bottom:8px; display: flex; justify-content: space-between; align-items: center;}
        
        .preview-img { width: 80px; height: 80px; object-fit: cover; border-radius: 5px; border: 1px solid #ddd; background: #eee;}
        
        .admin-item-row { display: flex; gap: 10px; align-items: flex-start; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #f0f0f0; }
        .admin-item-row:last-child { border-bottom: none; }
        .admin-item-info { flex-grow: 1; display: flex; flex-direction: column; gap: 5px; }
        .admin-item-info input[type="text"], .admin-item-info input[type="number"] { padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; width: 100%; }
        .admin-item-info label { font-size: 12px; color: #666; font-weight: bold; }
        .admin-item-info input[type="file"] { font-size: 12px; }
        
        .admin-sub-section { margin-left: 10px; padding: 10px; background: #fafafa; border-left: 3px solid #ddd; margin-top: 5px; }
        .admin-sub-item { display: flex; gap: 5px; margin-bottom: 5px; align-items: center; }

        .btn-danger { background: #ffcdd2; color: #c62828; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: bold; height: fit-content; align-self: center; white-space: nowrap;}
        .btn-danger:hover { background: #ef9a9a; }
        
        .btn-add { background: #e3f2fd; color: #1565c0; border: 1px dashed #1565c0; padding: 10px; border-radius: 8px; cursor: pointer; width: 100%; margin-top: 5px; font-weight: bold; transition: 0.2s; }
        .btn-add:hover { background: #bbdefb; }
        .btn-add-small { background: #f1f8e9; color: #2e7d32; border: 1px dashed #2e7d32; padding: 5px; font-size: 12px; margin-top: 5px; cursor: pointer; border-radius: 4px; }
        
        .btn-save-container { position: fixed; bottom: 0; right: 0; width: 100%; max-width: 450px; padding: 15px; background: white; border-top: 1px solid #ddd; z-index: 11; }
        .btn-save { background: linear-gradient(135deg, #4caf50, #2e7d32); color: white; padding: 15px; font-size: 16px; border: none; border-radius: 8px; width: 100%; box-shadow: 0 4px 10px rgba(0,0,0,0.2); cursor: pointer; font-weight: bold; letter-spacing: 0.5px; }
        .btn-save:disabled { background: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="loading-screen">
        <h2>Memuat Halaman...</h2>
        <div class="loading-bar"><div class="loading-fill"></div></div>
        <p class="loading-text">0%</p>
    </div>
    
    <div id="admin-login-modal" class="admin-modal">
        <div class="admin-box">
            <h2 style="color:#e65100; margin-bottom:15px;">Admin Login</h2>
            <input type="email" id="admin-email" placeholder="Email Admin">
            <input type="password" id="admin-password" placeholder="Password">
            <button onclick="loginAdmin()">Masuk</button>
            <button class="close-admin" onclick="closeAdminLogin()">Batal</button>
        </div>
    </div>
    
    <button id="open-dashboard-btn" class="admin-panel-btn" onclick="openDashboard()">‚öôÔ∏è EDIT WEBSITE</button>

    <div id="admin-dashboard" class="admin-dashboard">
        <div class="dashboard-header">
            <h2 style="font-size: 18px;">Dashboard Admin</h2>
            <button onclick="closeDashboard()" style="background:#ffcdd2; color:#c62828; border:none; padding:8px 12px; border-radius:5px; font-weight:bold; width:auto; margin:0;">Tutup</button>
        </div>
        <div class="dashboard-content" id="admin-content-area">
            <p style="text-align:center; padding: 20px;">Memuat data konfigurasi...</p>
        </div>
        <div class="btn-save-container">
            <button class="btn-save" onclick="saveConfigToFirestore()">üíæ SIMPAN PERUBAHAN</button>
        </div>
    </div>

    <div id="page-home" class="page-content">
        <div class="header-gallery">
            <img id="header-main-img" src="" alt="Header Image" />
        </div>
        <div class="main-container">
            <div class="slideshow-container" id="slideshow-wrapper">
                <img id="overlay-frame-img" src="" class="frame-overlay" alt="Frame Decoration">
            </div>

            <div class="menu-grid-container">
                <a onclick="showPage('page-reguler')" class="menu-card bg-orange">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/></svg><span>Menu<br>Reguler</span>
                </a>
                <a onclick="showPage('page-menu')" class="menu-card bg-green">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7V5h10v14zM9 7h6v2H9zm0 4h6v2H9zm0 4h4v2H9z"/></svg><span>Menu<br>Reservasi</span>
                </a>
                <a onclick="showPage('page-gallery')" class="menu-card bg-orange">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg><span>Gallery<br>Lokasi</span>
                </a>
                <a onclick="showPage('page-jadwal')" class="menu-card bg-green">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg><span>Jadwal<br>Buka</span>
                </a>
                <a onclick="showPage('page-jeep')" class="menu-card bg-orange">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,12H5L6,8H18L19,12M20,13V7H4V13L2,13V16C2,17.1 2.9,18 4,18V21C4,21.55 4.45,22 5,22H7C7.55,22 8,21.55 8,21V18H16V21C16,21.55 16.45,22 17,22H19C19.55,22 20,21.55 20,21V18C21.1,18 22,17.1 22,16V13L20,13M6.5,16C5.67,16 5,15.33 5,14.5C5,13.67 5.67,13 6.5,13C7.33,13 8,13.67 8,14.5C8,15.33 7.33,16 6.5,16M17.5,16C16.67,16 16,15.33 16,14.5C16,13.67 16.67,13 17.5,13C18.33,13 19,13.67 19,14.5C19,15.33 18.33,16 17.5,16Z"/></svg><span>Jeep<br>Adventure</span>
                </a>
                <a href="https://maps.app.goo.gl/gCyTugKbGJEdobXs8?g_st=ic" target="_blank" class="menu-card bg-green">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg><span>Lokasi<br>Maps</span>
                </a>
                <a href="https://dewatalaptop.github.io/checkerds" target="_blank" class="menu-card full-width-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/></svg><span>Cek Ketersediaan Tempat</span>
                </a>
            </div>
            
            <a href="https://wa.me/6285601393640" class="floating-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01s-.521.074-.792.372c-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.626.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z" fill-rule="evenodd"/></svg>
                <span>Reservasi via WhatsApp</span>
            </a>
        </div>
    </div>
    
    <div id="page-menu" class="page-content">
        <div class="container" id="reservation-menu-container">
            <h1>Menu Reservasi</h1>
            <div id="reservation-menu-list"></div>
        </div>
    </div>
    
    <div id="page-gallery" class="page-content">
        <div class="container">
            <h1>Galeri Dolan Sawah</h1><p>Klik gambar untuk memperbesar.</p>
            <div class="gallery" id="gallery-grid"></div>
        </div>
    </div>
    
    <div id="page-jadwal" class="page-content">
        <div class="container">
            <h1>Jadwal Buka</h1>
            <p class="schedule">Senin - Minggu<br />06.00 - 22.00</p>
            <p class="footer">Dolan Sawah - Tempat Wisata & Kuliner</p>
        </div>
    </div>
    
    <div id="page-jeep" class="page-content">
        <div class="container">
            <h1>Paket Jeep Adventure</h1>
            <p class="subtitle">Jelajahi keindahan alam dengan paket wisata Jeep kami. Klik paket untuk melihat detail.</p>
            <div class="jeep-packages-grid" id="jeep-packages-list"></div>
        </div>
    </div>
    
    <div id="page-reguler" class="page-content">
        <div class="menu-container">
            <h1>Daftar Menu Reguler</h1>
            <div id="regular-menu-list"></div>
            <p style="text-align:center; margin-top:20px;">*Harga belum termasuk PPN</p>
        </div>
    </div>
    
    <div class="fullscreen-modal" id="fullscreen-modal" onclick="closeFullscreen()">
        <img id="fullscreen-img" src="" alt="Gambar besar" referrerpolicy="no-referrer" onclick="event.stopPropagation()">
        <button class="close-btn" onclick="closeFullscreen()">‚úï</button>
    </div>

    <div id="generic-popup" class="popup-overlay" onclick="closePopup()"><div class="popup-content" onclick="event.stopPropagation()"><h2 id="popup-title"></h2><div id="popup-body"></div><button id="popup-button" class="popup-button" onclick="closePopup()">Tutup</button></div></div>
    
    <div id="scroll-indicator">Scroll ke Bawah <span>‚Üì</span></div>

    <button id="floating-home-button" onclick="showPage('page-home')">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg><span>Kembali</span>
    </button>
    
    <a id="floating-member-button" href="https://www.dolansawah.my.id/daftarmember.html" target="_blank">
        <img id="member-btn-img" src="" alt="Tombol Member Area">
    </a>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

        // FIREBASE CONFIG
        const firebaseConfig = {
          apiKey: "AIzaSyAk0CnaeiRRBqo5O_DnFUDpGHSM017wNiU",
          authDomain: "slidemonitor.firebaseapp.com",
          projectId: "slidemonitor",
          storageBucket: "slidemonitor.firebasestorage.app",
          messagingSenderId: "1010222267025",
          appId: "1:1010222267025:web:d5448ad6c1e3d02b90dd30"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // DATA STRUKTUR BARU (Advanced)
        const defaultData = {
            general: {
                headerImage: "https://res.cloudinary.com/dn60ib3ur/image/upload/v1752467234/IMG_5184_qcsvrt.jpg",
                overlayImage: "https://res.cloudinary.com/dn60ib3ur/image/upload/v1765194271/IMG_7534_xbo5fc.png",
                memberBtnImage: "https://res.cloudinary.com/dn60ib3ur/image/upload/v1762433981/IMG_7095_muk3qw.png"
            },
            slideshow: [
                "https://res.cloudinary.com/dn60ib3ur/image/upload/v1752755554/IMG_5218_k3sgqn.jpg",
                "https://res.cloudinary.com/dn60ib3ur/image/upload/v1752755554/IMG_5217_ui0bir.jpg",
                "https://res.cloudinary.com/dn60ib3ur/image/upload/v1752755554/IMG_5223_gaiovo.jpg"
            ],
            jeepPackages: [
                { title: "Paket Short Trip", image: "https://res.cloudinary.com/dn60ib3ur/image/upload/w_400,ar_1:1,c_fill/v1760066030/IMG_6559_bvqd6w.jpg" },
                { title: "Paket Medium Trip", image: "https://res.cloudinary.com/dn60ib3ur/image/upload/w_400,ar_1:1,c_fill/v1760066034/IMG_6560_laiobh.jpg" },
                { title: "Paket Off-road Kering", image: "https://res.cloudinary.com/dn60ib3ur/image/upload/w_400,ar_1:1,c_fill/v1760066034/IMG_6561_ljijy0.jpg" },
                { title: "Paket Long Trip", image: "https://res.cloudinary.com/dn60ib3ur/image/upload/w_400,ar_1:1,c_fill/v1760066035/IMG_6563_xg0oov.jpg" }
            ],
            gallery: [
                "https://res.cloudinary.com/dn60ib3ur/image/upload/v1752465151/IMG_5179_gaqxnv.jpg",
                "https://res.cloudinary.com/dn60ib3ur/image/upload/v1752465454/IMG_5180_ws8xwl.jpg"
            ],
            reservationMenu: [
                { title: "Paket Prasmanan", image: "https://res.cloudinary.com/dn60ib3ur/image/upload/v1754808317/E983BD8B-5D43-448A-9E32-DB52316FA7E8_ls3xed.jpg", desc: "Minimal H-3 sebelum acara." },
                { title: "Paket Kembulan", image: "https://res.cloudinary.com/dn60ib3ur/image/upload/v1752461119/91d77689-1e31-4293-921e-3b52b6e61a2e_mb4ft3.jpg", desc: "Minimal pemesanan H-1." },
                { title: "Tumpeng Nasi Kuning", image: "https://res.cloudinary.com/dn60ib3ur/image/upload/v1757126294/IMG_6002_kmtqob.png", desc: "Minimal pemesanan H-1." },
                { title: "Paket Rantang", image: "https://res.cloudinary.com/dn60ib3ur/image/upload/v1752461212/ec438e76-f56a-417c-97f6-6b68cb62c85d_pw5uxi.jpg", desc: "Bisa dipesan dadakan." }
            ],
            regularMenu: [
                {
                    category: "Daging, Ayam & Bebek",
                    items: [
                        { name: "Iga Bakar", price: "55.000" },
                        { name: "Opor Bebek", price: "38.000" }
                    ]
                },
                {
                    category: "Minuman Segar",
                    items: [
                        { name: "Es Teh Manis", price: "5.000" },
                        { name: "Jus Jeruk", price: "12.000" }
                    ]
                }
            ]
        };

        let globalConfig = null;
        let headerClickCount = 0;

        // AUTH LOGIC
        document.querySelector('.header-gallery').addEventListener('click', () => {
            headerClickCount++;
            if(headerClickCount === 5) {
                document.getElementById('admin-login-modal').style.display = 'flex';
                headerClickCount = 0;
            }
            setTimeout(() => { headerClickCount = 0; }, 2000);
        });

        window.loginAdmin = async () => {
            const email = document.getElementById('admin-email').value;
            const pass = document.getElementById('admin-password').value;
            try {
                await signInWithEmailAndPassword(auth, email, pass);
                alert("Login Berhasil!");
                document.getElementById('admin-login-modal').style.display = 'none';
            } catch (e) { alert("Login Gagal: " + e.message); }
        };
        window.closeAdminLogin = () => document.getElementById('admin-login-modal').style.display = 'none';
        
        onAuthStateChanged(auth, (user) => {
            document.getElementById('open-dashboard-btn').style.display = user ? 'block' : 'none';
        });

        // GANTI FUNGSI loadData() YANG LAMA DENGAN INI:

async function loadData() {
    try {
        const docRef = doc(db, "website_data", "master_config_v4");
        
        // Tambahkan opsi 'source: default' agar mencoba ambil dari server dulu
        const docSnap = await getDoc(docRef);

        if (docSnap.exists()) {
            console.log("Data ditemukan di Firebase!");
            globalConfig = docSnap.data();
            
            // Pengecekan data kosong untuk menjaga struktur
            if(!globalConfig.general) globalConfig.general = defaultData.general;
            if(!globalConfig.reservationMenu) globalConfig.reservationMenu = defaultData.reservationMenu;
            if(!globalConfig.regularMenu) globalConfig.regularMenu = defaultData.regularMenu;
            if(!globalConfig.slideshow) globalConfig.slideshow = defaultData.slideshow;
            if(!globalConfig.jeepPackages) globalConfig.jeepPackages = defaultData.jeepPackages;
            if(!globalConfig.gallery) globalConfig.gallery = defaultData.gallery;

            renderWebsite(globalConfig);
        } else {
            console.warn("Dokumen tidak ditemukan, menggunakan default.");
            // Jika dokumen benar-benar tidak ada (belum pernah disimpan), baru pakai default
            globalConfig = defaultData;
            renderWebsite(globalConfig);
        }
    } catch (e) {
        // JANGAN SILENT! Tampilkan error di console dan alert jika perlu
        console.error("GAGAL MEMUAT DATA:", e);
        alert("Gagal mengambil data terbaru: " + e.message + "\nMenampilkan data default sementara.");
        
        globalConfig = defaultData; 
        renderWebsite(globalConfig);
    }
    
    // Hapus loading screen
    document.querySelector(".loading-fill").style.width = "100%";
    document.querySelector(".loading-text").textContent = "100%";
    setTimeout(() => {
        document.querySelector(".loading-screen").style.display = "none";
        const hash = window.location.hash.substring(1);
        if(hash && document.getElementById(hash)) showPage(hash);
        else showPage("page-home");
    }, 500);
}


        // RENDER WEBSITE UTAMA
        function renderWebsite(data) {
            // A. General
            if (data.general) {
                document.getElementById('header-main-img').src = data.general.headerImage;
                document.getElementById('overlay-frame-img').src = data.general.overlayImage;
                document.getElementById('member-btn-img').src = data.general.memberBtnImage;
            }

            // B. Slideshow
            const slideWrapper = document.getElementById('slideshow-wrapper');
            const overlay = slideWrapper.querySelector('.frame-overlay');
            slideWrapper.innerHTML = '';
            slideWrapper.appendChild(overlay);
            if (data.slideshow && data.slideshow.length > 0) {
                data.slideshow.forEach((url, i) => {
                    const img = document.createElement('img');
                    img.src = url;
                    img.className = `slide-image ${i===0 ? 'active' : ''}`;
                    slideWrapper.appendChild(img);
                });
                startSlideshow();
            }

            // C. Menu Reservasi
            const resList = document.getElementById('reservation-menu-list');
            resList.innerHTML = '';
            if(data.reservationMenu) {
                data.reservationMenu.forEach((item, idx) => {
                    resList.innerHTML += `
                        <h2>${item.title}</h2>
                        <div class="image-container" onclick="openPopup('${item.title}', '${item.desc}')">
                            <img src="${item.image}" alt="${item.title}" />
                        </div>
                    `;
                });
            }

            // D. Gallery
            const galGrid = document.getElementById('gallery-grid');
            galGrid.innerHTML = '';
            if (data.gallery) {
                data.gallery.forEach(url => {
                    galGrid.innerHTML += `<img src="${url}" onclick="openFullscreen(this)">`;
                });
            }

            // E. Jeep Packages
            const jeepGrid = document.getElementById('jeep-packages-list');
            jeepGrid.innerHTML = '';
            if (data.jeepPackages) {
                data.jeepPackages.forEach(pkg => {
                    jeepGrid.innerHTML += `
                        <div class="jeep-package-card" onclick="openFullscreenImage('${pkg.image}')">
                            <img src="${pkg.image}">
                            <div class="card-content"><h3>${pkg.title}</h3><span>Lihat Detail</span></div>
                        </div>`;
                });
            }

            // F. Menu Reguler
            const regList = document.getElementById('regular-menu-list');
            regList.innerHTML = '';
            if(data.regularMenu) {
                data.regularMenu.forEach(cat => {
                    let itemsHtml = '';
                    cat.items.forEach(itm => {
                        itemsHtml += `
                        <div class="menu-item">
                            <span class="item-name">${itm.name}</span>
                            <span class="item-dots"></span>
                            <span class="item-price">Rp ${itm.price}</span>
                        </div>`;
                    });
                    
                    regList.innerHTML += `
                    <div class="menu-category">
                        <h2 class="category-title">${cat.category}</h2>
                        ${itemsHtml}
                    </div>`;
                });
            }
        }

        let slideInterval;
        function startSlideshow() {
            if(slideInterval) clearInterval(slideInterval);
            let idx = 0;
            slideInterval = setInterval(() => {
                const slides = document.querySelectorAll('.slide-image');
                if(slides.length === 0) return;
                slides.forEach(s => s.classList.remove('active'));
                idx = (idx + 1) % slides.length;
                slides[idx].classList.add('active');
            }, 4000);
        }

        // --- ADMIN DASHBOARD GENERATOR ---
        window.openDashboard = () => {
            document.getElementById('admin-dashboard').style.display = 'block';
            generateAdminForm();
        };
        window.closeDashboard = () => document.getElementById('admin-dashboard').style.display = 'none';

        function generateAdminForm() {
            const area = document.getElementById('admin-content-area');
            let html = '';

            // 0. GENERAL SETTINGS (HEADER, OVERLAY, MEMBER BTN) - ADDED
            html += `<div class="upload-group"><h3>Pengaturan Umum (Gambar Utama)</h3>`;
            
            // Header Image
            html += `<div class="admin-item-row">
                <img src="${globalConfig.general.headerImage}" class="preview-img">
                <div class="admin-item-info">
                    <label>Gambar Header (Banner Atas)</label>
                    <input type="file" onchange="uploadFile(this, 'general', 'headerImage')">
                </div>
            </div>`;

            // Overlay Image
            html += `<div class="admin-item-row">
                <img src="${globalConfig.general.overlayImage}" class="preview-img">
                <div class="admin-item-info">
                    <label>Overlay/Frame Slideshow</label>
                    <input type="file" onchange="uploadFile(this, 'general', 'overlayImage')">
                </div>
            </div>`;

             // Member Button Image
             html += `<div class="admin-item-row">
                <img src="${globalConfig.general.memberBtnImage}" class="preview-img">
                <div class="admin-item-info">
                    <label>Tombol Member (Pojok Kanan Bawah)</label>
                    <input type="file" onchange="uploadFile(this, 'general', 'memberBtnImage')">
                </div>
            </div>`;
            html += `</div>`;


            // 1. SLIDESHOW
            html += `<div class="upload-group"><h3>Slideshow (Carousel)</h3>`;
            globalConfig.slideshow.forEach((url, i) => {
                html += `<div class="admin-item-row">
                    <img src="${url}" class="preview-img">
                    <div class="admin-item-info"><input type="file" onchange="uploadFile(this, 'slide', ${i})"></div>
                    <button class="btn-danger" onclick="deleteArrayItem('slideshow', ${i})">Hapus</button>
                </div>`;
            });
            html += `<button class="btn-add" onclick="addArrayItem('slideshow')">+ Tambah Slide</button></div>`;

            // 2. JEEP PACKAGES
            html += `<div class="upload-group"><h3>Paket Jeep</h3>`;
            globalConfig.jeepPackages.forEach((pkg, i) => {
                html += `<div class="admin-item-row" style="background:#f9f9f9; padding:10px; border-radius:8px;">
                    <img src="${pkg.image}" class="preview-img">
                    <div class="admin-item-info">
                        <label>Nama Paket:</label>
                        <input type="text" value="${pkg.title}" oninput="updateDeepValue('jeepPackages', ${i}, 'title', this.value)">
                        <input type="file" onchange="uploadFile(this, 'jeep', ${i})">
                    </div>
                    <button class="btn-danger" onclick="deleteArrayItem('jeepPackages', ${i})">Hapus</button>
                </div>`;
            });
            html += `<button class="btn-add" onclick="addArrayItem('jeepPackages')">+ Tambah Paket Jeep</button></div>`;

            // 3. MENU RESERVASI
            html += `<div class="upload-group"><h3>Menu Reservasi (Gambar & Ketentuan)</h3>`;
            globalConfig.reservationMenu.forEach((item, i) => {
                html += `<div class="admin-item-row" style="background:#f9f9f9; padding:10px; border-radius:8px;">
                    <img src="${item.image}" class="preview-img">
                    <div class="admin-item-info">
                        <label>Judul Menu:</label>
                        <input type="text" value="${item.title}" oninput="updateDeepValue('reservationMenu', ${i}, 'title', this.value)">
                        <label>Ketentuan (Popup):</label>
                        <input type="text" value="${item.desc}" oninput="updateDeepValue('reservationMenu', ${i}, 'desc', this.value)">
                        <input type="file" onchange="uploadFile(this, 'resMenu', ${i})">
                    </div>
                    <button class="btn-danger" onclick="deleteArrayItem('reservationMenu', ${i})">Hapus</button>
                </div>`;
            });
            html += `<button class="btn-add" onclick="addArrayItem('reservationMenu')">+ Tambah Menu Reservasi</button></div>`;

            // 4. MENU REGULER
            html += `<div class="upload-group"><h3>Menu Reguler (Kategori & Item)</h3>`;
            globalConfig.regularMenu.forEach((cat, catIdx) => {
                html += `<div style="background:#f5f5f5; padding:10px; border-radius:8px; margin-bottom:15px; border:1px solid #ddd;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <input type="text" value="${cat.category}" style="font-weight:bold; color:#e65100; width:70%;" oninput="updateCatTitle(${catIdx}, this.value)">
                        <button class="btn-danger" onclick="deleteRegularCategory(${catIdx})">Hapus Kategori</button>
                    </div>
                    <div class="admin-sub-section">`;
                
                cat.items.forEach((item, itemIdx) => {
                    html += `<div class="admin-sub-item">
                        <input type="text" value="${item.name}" placeholder="Nama Menu" style="width:50%" oninput="updateRegItem(${catIdx}, ${itemIdx}, 'name', this.value)">
                        <input type="text" value="${item.price}" placeholder="Harga" style="width:30%" oninput="updateRegItem(${catIdx}, ${itemIdx}, 'price', this.value)">
                        <button class="btn-danger" style="padding:5px;" onclick="deleteRegItem(${catIdx}, ${itemIdx})">X</button>
                    </div>`;
                });
                
                html += `<button class="btn-add-small" onclick="addRegItem(${catIdx})">+ Tambah Menu di ${cat.category}</button>
                    </div>
                </div>`;
            });
            html += `<button class="btn-add" onclick="addRegularCategory()">+ Tambah Kategori Baru</button></div>`;

            // 5. GALERI & UMUM
            html += `<div class="upload-group"><h3>Galeri Foto</h3><div style="display:flex; flex-wrap:wrap; gap:8px;">`;
            globalConfig.gallery.forEach((url, i) => {
                html += `<div style="position:relative; width:80px; height:80px;">
                    <img src="${url}" style="width:100%; height:100%; object-fit:cover; border-radius:5px;">
                    <button onclick="deleteArrayItem('gallery', ${i})" style="position:absolute; top:-5px; right:-5px; background:red; color:white; border:none; border-radius:50%; width:20px; height:20px; font-size:10px; cursor:pointer;">X</button>
                </div>`;
            });
            html += `</div><br><button class="btn-add" onclick="document.getElementById('input-gallery-add').click()">+ Upload Foto</button>
            <input type="file" id="input-gallery-add" style="display:none" onchange="uploadFile(this, 'gallery_add')"></div>`;

            area.innerHTML = html;
        }

        // --- ADMIN ACTIONS LOGIC ---
        
        window.addArrayItem = (key) => {
            if(key === 'slideshow') globalConfig.slideshow.push("https://via.placeholder.com/800x400?text=New+Slide");
            if(key === 'jeepPackages') globalConfig.jeepPackages.push({ title: "Paket Baru", image: "https://via.placeholder.com/400" });
            if(key === 'reservationMenu') globalConfig.reservationMenu.push({ title: "Menu Baru", image: "https://via.placeholder.com/400", desc: "Keterangan disini" });
            generateAdminForm();
        };

        window.deleteArrayItem = (key, index) => {
            if(!confirm("Yakin hapus?")) return;
            globalConfig[key].splice(index, 1);
            generateAdminForm();
        };

        window.updateDeepValue = (key, index, field, value) => {
            globalConfig[key][index][field] = value;
        };

        // Regular Menu Logic
        window.addRegularCategory = () => {
            globalConfig.regularMenu.push({ category: "Kategori Baru", items: [] });
            generateAdminForm();
        };
        window.deleteRegularCategory = (idx) => {
            if(!confirm("Hapus kategori dan semua isinya?")) return;
            globalConfig.regularMenu.splice(idx, 1);
            generateAdminForm();
        };
        window.updateCatTitle = (idx, val) => {
            globalConfig.regularMenu[idx].category = val;
        };
        window.addRegItem = (catIdx) => {
            globalConfig.regularMenu[catIdx].items.push({ name: "Menu Baru", price: "0" });
            generateAdminForm();
        };
        window.deleteRegItem = (catIdx, itemIdx) => {
            globalConfig.regularMenu[catIdx].items.splice(itemIdx, 1);
            generateAdminForm();
        };
        window.updateRegItem = (catIdx, itemIdx, field, val) => {
            globalConfig.regularMenu[catIdx].items[itemIdx][field] = val;
        };

        // Upload Logic
        window.uploadFile = async (input, type, key) => {
            const file = input.files[0];
            if(!file) return;
            const btnSave = document.querySelector('.btn-save');
            btnSave.disabled = true; btnSave.innerText = "UPLOADING...";

            try {
                const storageRef = ref(storage, `uploads_v4/${type}_${Date.now()}_${file.name}`);
                const snapshot = await uploadBytes(storageRef, file);
                const url = await getDownloadURL(snapshot.ref);

                if (type === 'general') {
                    // Logic baru untuk Header, Overlay, Member Btn
                    globalConfig.general[key] = url;
                }
                else if (type === 'slide') globalConfig.slideshow[key] = url;
                else if (type === 'jeep') globalConfig.jeepPackages[key].image = url;
                else if (type === 'resMenu') globalConfig.reservationMenu[key].image = url;
                else if (type === 'gallery_add') globalConfig.gallery.push(url);
                
                generateAdminForm();
            } catch (error) {
                alert("Upload Gagal: " + error.message);
            } finally {
                btnSave.disabled = false; btnSave.innerText = "üíæ SIMPAN PERUBAHAN";
            }
        };

        window.saveConfigToFirestore = async () => {
            const btn = document.querySelector('.btn-save');
            btn.disabled = true; btn.innerText = "MENYIMPAN...";
            try {
                await setDoc(doc(db, "website_data", "master_config_v4"), globalConfig);
                alert("BERHASIL! Website telah diperbarui.");
                location.reload();
            } catch (e) {
                alert("Gagal menyimpan: " + e.message);
                btn.disabled = false; btn.innerText = "üíæ SIMPAN PERUBAHAN";
            }
        };

        // UI Helpers
        window.showPage = (pageId) => {
            document.querySelectorAll('.page-content').forEach(p => p.style.display = 'none');
            const target = document.getElementById(pageId);
            if(target) target.style.display = 'block';
            window.scrollTo(0,0);
            
            document.body.className = '';
            if(pageId === 'page-home') document.body.classList.add('theme-home');
            else if(pageId === 'page-menu') document.body.classList.add('theme-menu');
            else if(pageId === 'page-gallery') document.body.classList.add('theme-gallery');
            else if(pageId === 'page-jeep') document.body.classList.add('theme-jeep');
            else if(pageId === 'page-reguler') document.body.classList.add('theme-reguler');

            document.getElementById('floating-home-button').style.display = (pageId === 'page-home') ? 'none' : 'flex';
            const ind = document.getElementById('scroll-indicator');
            if(ind) ind.style.display = (['page-menu','page-reguler'].includes(pageId)) ? 'flex' : 'none';
        };

        window.openFullscreen = (img) => {
            document.getElementById("fullscreen-img").src = img.src;
            document.getElementById("fullscreen-modal").classList.add("show");
        };
        window.openFullscreenImage = (url) => {
             document.getElementById("fullscreen-img").src = url;
             document.getElementById("fullscreen-modal").classList.add("show");
        };
        window.closeFullscreen = () => document.getElementById("fullscreen-modal").classList.remove("show");

        const popup = document.getElementById("generic-popup");
        window.openPopup = (t, b) => {
            document.getElementById("popup-title").innerText = t;
            document.getElementById("popup-body").innerHTML = `<p>${b}</p>`;
            popup.classList.add("show");
        };
        window.closePopup = () => popup.classList.remove("show");

        document.addEventListener("DOMContentLoaded", loadData);
    </script>
</body>
</html>
