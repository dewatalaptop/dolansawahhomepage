<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Dolan Sawah</title>
    
    <style>
        /* Reset & Font Dasar */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f9f9f9;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 0 1rem;
        }

        /* --- Header --- */
        header {
            background-color: #2c5e2e;
            color: white;
            padding: 1rem;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        
        header h1 {
            font-size: 1.75rem;
        }
        
        /* --- Navigasi Tab --- */
        nav {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #ddd;
        }
        
        .nav-tab {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            background: none;
            color: #777;
            border-bottom: 3px solid transparent;
        }
        
        .nav-tab.active {
            color: #2c5e2e;
            border-bottom-color: #2c5e2e;
        }
        
        /* --- Konten Section (Tab) --- */
        .content-section {
            display: none; /* Sembunyi by default */
        }
        
        .content-section.active {
            display: block; /* Tampil jika aktif */
        }
        
        /* --- Styling Form --- */
        .form-card {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 1.5rem;
        }
        
        .form-card h2 {
            font-size: 1.4rem;
            color: #2c5e2e;
            margin-bottom: 1rem;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 0.5rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .submit-btn {
            background-color: #2c5e2e;
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .submit-btn:hover {
            background-color: #1e421e;
        }
        
        /* --- Daftar Item (Menu & Voucher) --- */
        .list-container {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        
        .list-container h2 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
        }
        
        .list-item {
            display: flex;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .list-item:last-child {
            border-bottom: none;
        }
        
        .list-item img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 6px;
            margin-right: 1rem;
        }
        
        .item-info {
            flex-grow: 1;
        }
        
        .item-info h3 {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .item-info p {
            font-size: 0.9rem;
            color: #666;
        }
        
        .item-price {
            font-size: 1.1rem;
            font-weight: 700;
            color: #d9534f;
        }
        
        .item-code {
            font-family: 'Courier New', Courier, monospace;
            font-weight: 700;
            background: #eee;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

    </style>
</head>
<body>

    <header>
        <h1>Admin - Dolan Sawah Delivery</h1>
    </header>

    <main class="container">
        
        <nav>
            <button class="nav-tab active" data-tab="menu">Kelola Menu</button>
            <button class="nav-tab" data-tab="voucher">Kelola Voucher</button>
        </nav>

        <section id="content-menu" class="content-section active">
            
            <div class="form-card">
                <h2>Tambah Menu Baru</h2>
                <form id="form-add-menu">
                    <div class="form-group">
                        <label for="menu-name">Nama Menu</label>
                        <input type="text" id="menu-name" placeholder="Contoh: Nasi Pecel Komplit" required>
                    </div>
                    <div class="form-group">
                        <label for="menu-category">Kategori</label>
                        <input type="text" id="menu-category" placeholder="Contoh: Makanan Utama / Minuman" required>
                    </div>
                    <div class="form-group">
                        <label for="menu-description">Deskripsi Singkat</label>
                        <textarea id="menu-description" placeholder="Contoh: Nasi pecel, tempe, tahu, peyek"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="menu-price">Harga (Rp)</label>
                        <input type="number" id="menu-price" placeholder="Contoh: 20000 (tanpa titik/Rp)" required>
                    </div>
                    <div class="form-group">
                        <label for="menu-img">Link Foto Menu</label>
                        <input type="url" id="menu-img" placeholder="https://... (Paste link gambar di sini)" required>
                    </div>
                    <button type="submit" class="submit-btn">Simpan Menu</button>
                </form>
            </div>
            
            <div class="list-container">
                <h2>Daftar Menu Saat Ini</h2>
                <div id="menu-list">
                    </div>
            </div>
        </section>

        <section id="content-voucher" class="content-section">

            <div class="form-card">
                <h2>Tambah Voucher Baru</h2>
                <form id="form-add-voucher">
                    <div class="form-group">
                        <label for="voucher-code">Kode Voucher</label>
                        <input type="text" id="voucher-code" placeholder="Contoh: HEMAT10K (huruf besar)" required>
                    </div>
                    <div class="form-group">
                        <label for="voucher-min">Minimal Transaksi (Rp)</label>
                        <input type="number" id="voucher-min" placeholder="Contoh: 75000 (untuk min. belanja 75rb)" required>
                    </div>
                    <div class="form-group">
                        <label for="voucher-discount">Nilai Diskon (Rp)</label>
                        <input type="number" id="voucher-discount" placeholder="Contoh: 10000 (untuk diskon 10rb)" required>
                    </div>
                    <button type="submit" class="submit-btn">Simpan Voucher</button>
                </form>
            </div>

            <div class="list-container">
                <h2>Daftar Voucher Saat Ini</h2>
                <div id="voucher-list">
                    </div>
            </div>
        </section>

    </main>

    <script>
        // --- DATABASE TIRUAN (Ganti ini dengan data dari Firebase) ---
        // Saya sertakan data awal agar daftar tidak kosong
        let mockProducts = [
            { id: 1, name: "Nasi Pecel Komplit", category: "Makanan Utama", description: "Nasi pecel, tempe, tahu, peyek", price: 20000, img: "https://via.placeholder.com/100x100.png?text=Pecel" },
            { id: 2, name: "Ayam Bakar Madu", category: "Makanan Utama", description: "Ayam bakar bumbu madu, lalapan, sambal", price: 25000, img: "https://via.placeholder.com/100x100.png?text=Ayam+Bakar" },
            { id: 4, name: "Es Teh Manis", category: "Minuman", description: "Teh segar dengan gula asli", price: 5000, img: "https://via.placeholder.com/100x100.png?text=Es+Teh" }
        ];

        let mockVouchers = [
            { id: "v1", code: "HEMAT10K", minTransaction: 75000, discountValue: 10000 },
            { id: "v2", code: "FREEDELIVERY", minTransaction: 50000, discountValue: 14000 }
        ];
        
        // Fungsi untuk memformat angka ke Rupiah
        function formatRupiah(number) {
            return new Intl.NumberFormat('id-ID').format(number);
        }

        // --- Logika Render Daftar ---
        
        function renderMenuList() {
            const listContainer = document.getElementById('menu-list');
            listContainer.innerHTML = ''; // Kosongkan dulu
            
            // Nantinya, 'mockProducts' ini akan Anda dapatkan dari query ke Firestore
            // Contoh: const snapshot = await getDocs(collection(db, "products"));
            
            if (mockProducts.length === 0) {
                listContainer.innerHTML = '<p>Belum ada menu.</p>';
                return;
            }
            
            mockProducts.forEach(product => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <img src="${product.img}" alt="${product.name}">
                    <div class="item-info">
                        <h3>${product.name}</h3>
                        <p>${product.description} (${product.category})</p>
                    </div>
                    <div class="item-price">Rp ${formatRupiah(product.price)}</div>
                `;
                listContainer.appendChild(item);
            });
        }
        
        function renderVoucherList() {
            const listContainer = document.getElementById('voucher-list');
            listContainer.innerHTML = ''; // Kosongkan dulu
            
            // Nantinya, 'mockVouchers' ini akan Anda dapatkan dari query ke Firestore
            // Contoh: const snapshot = await getDocs(collection(db, "vouchers"));
            
            if (mockVouchers.length === 0) {
                listContainer.innerHTML = '<p>Belum ada voucher.</p>';
                return;
            }
            
            mockVouchers.forEach(voucher => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <div class="item-info">
                        <h3>Kode: <span class="item-code">${voucher.code}</span></h3>
                        <p>Diskon Rp ${formatRupiah(voucher.discountValue)} (Min. belanja Rp ${formatRupiah(voucher.minTransaction)})</p>
                    </div>
                `;
                listContainer.appendChild(item);
            });
        }
        
        // --- Logika Form Submit ---
        
        function handleAddMenu(event) {
            event.preventDefault(); // Mencegah form reload halaman
            
            // 1. Ambil data dari form
            const newProduct = {
                id: Date.now(), // ID unik sementara
                name: document.getElementById('menu-name').value,
                category: document.getElementById('menu-category').value,
                description: document.getElementById('menu-description').value,
                price: parseInt(document.getElementById('menu-price').value),
                img: document.getElementById('menu-img').value
            };
            
            // 2. TODO: Simpan 'newProduct' ini ke Firebase Firestore
            // try {
            //    const docRef = await addDoc(collection(db, "products"), newProduct);
            //    console.log("Menu berhasil disimpan dengan ID: ", docRef.id);
            // } catch (e) {
            //    console.error("Error menambahkan menu: ", e);
            // }
            console.log("SIMULASI: Menyimpan menu ke Firebase ->", newProduct);
            
            // 3. (Simulasi) Tambahkan ke array lokal dan render ulang
            mockProducts.push(newProduct);
            renderMenuList();
            
            // 4. Kosongkan form
            event.target.reset();
        }
        
        function handleAddVoucher(event) {
            event.preventDefault();
            
            // 1. Ambil data dari form
            const newVoucher = {
                id: `v${Date.now()}`, // ID unik sementara
                code: document.getElementById('voucher-code').value.toUpperCase(),
                minTransaction: parseInt(document.getElementById('voucher-min').value),
                discountValue: parseInt(document.getElementById('voucher-discount').value),
                type: "fixed" // Anda hardcode "fixed" sesuai tipe diskon
            };
            
            // 2. TODO: Simpan 'newVoucher' ini ke Firebase Firestore
            // try {
            //    const docRef = await addDoc(collection(db, "vouchers"), newVoucher);
            //    console.log("Voucher berhasil disimpan dengan ID: ", docRef.id);
            // } catch (e) {
            //    console.error("Error menambahkan voucher: ", e);
            // }
            console.log("SIMULASI: Menyimpan voucher ke Firebase ->", newVoucher);
            
            // 3. (Simulasi) Tambahkan ke array lokal dan render ulang
            mockVouchers.push(newVoucher);
            renderVoucherList();
            
            // 4. Kosongkan form
            event.target.reset();
        }

        // --- Event Listeners (Menghubungkan Aksi) ---

        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.nav-tab');
            const sections = document.querySelectorAll('.content-section');
            
            // Logika ganti Tab
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Hapus 'active' dari semua tab dan section
                    tabs.forEach(t => t.classList.remove('active'));
                    sections.forEach(s => s.classList.remove('active'));
                    
                    // Tambahkan 'active' ke tab yang diklik
                    tab.classList.add('active');
                    // Tampilkan section yang sesuai
                    document.getElementById(`content-${tab.dataset.tab}`).classList.add('active');
                });
            });
            
            // Muat data awal (simulasi)
            renderMenuList();
            renderVoucherList();
            
            // Pasang listener ke form
            document.getElementById('form-add-menu').addEventListener('submit', handleAddMenu);
            document.getElementById('form-add-voucher').addEventListener('submit', handleAddVoucher);
        });

    </script>
</body>
</html>
